<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Laporan Dana Sosial Perumahan Rawinda Pratama 2022–2025</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body class="bg-light">
<div class="container my-4">
  <h1 class="text-center mb-4">Laporan Dana Sosial Perumahan Rawinda Pratama 2022–2025</h1>

  <!-- Tombol Export -->
  <div class="text-end mb-3">
    <button class="btn btn-success me-2" onclick="exportTableToExcel()">Export Excel</button>
    <button class="btn btn-danger" onclick="window.print()">Export PDF</button>
  </div>

  <!-- ================== Tabel Data ================== -->
  <div id="dataTables">
    <!-- Tahun 2022 -->
    <h3 class="mt-4">Tahun 2022</h3>
    <table class="table table-bordered table-striped" id="table2022">
      <thead class="table-dark">
        <tr>
          <th>Bulan</th><th>Pemasukan (Rp)</th><th>Pengeluaran (Rp)</th><th>Saldo (Rp)</th><th>Catatan</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Jan</td><td>-</td><td>-</td><td>1.040.000</td><td></td></tr>
        <tr><td>Feb</td><td>-</td><td>-</td><td>1.040.000</td><td></td></tr>
        <tr><td>Mar</td><td>-</td><td>-</td><td>1.040.000</td><td></td></tr>
        <tr><td>Apr</td><td>-</td><td>-</td><td>1.040.000</td><td></td></tr>
        <tr><td>Mei</td><td>105.000</td><td>-</td><td>1.145.000</td><td></td></tr>
        <tr><td>Jun</td><td>115.000</td><td>-</td><td>1.260.000</td><td></td></tr>
        <tr><td>Jul</td><td>110.000</td><td>-</td><td>1.370.000</td><td></td></tr>
        <tr><td>Agu</td><td>110.000</td><td>200.000</td><td>1.280.000</td><td>Bu Dilla</td></tr>
        <tr><td>Sep</td><td>95.000</td><td>-</td><td>1.375.000</td><td></td></tr>
        <tr><td>Okt</td><td>100.000</td><td>-</td><td>1.475.000</td><td></td></tr>
        <tr><td>Nov</td><td>100.000</td><td>-</td><td>1.575.000</td><td></td></tr>
        <tr><td>Des</td><td>110.000</td><td>200.000</td><td>1.485.000</td><td>Bu Tiffany</td></tr>
      </tbody>
      <tfoot class="table-secondary fw-bold">
        <tr><td>Total</td><td>845.000</td><td>400.000</td><td>1.485.000</td><td></td></tr>
      </tfoot>
    </table>

    <!-- Tahun 2023 -->
    <h3 class="mt-4">Tahun 2023</h3>
    <table class="table table-bordered table-striped" id="table2023">
      <thead class="table-dark">
        <tr>
          <th>Bulan</th><th>Pemasukan (Rp)</th><th>Pengeluaran (Rp)</th><th>Saldo (Rp)</th><th>Catatan</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Jan</td><td>105.000</td><td>-</td><td>1.590.000</td><td></td></tr>
        <tr><td>Feb</td><td>100.000</td><td>400.000</td><td>1.290.000</td><td>Bu Wiwik, Bu Eka</td></tr>
        <tr><td>Mar</td><td>100.000</td><td>200.000</td><td>1.190.000</td><td>Bu Wiwik</td></tr>
        <tr><td>Apr</td><td>105.000</td><td>-</td><td>1.295.000</td><td></td></tr>
        <tr><td>Mei</td><td>105.000</td><td>200.000</td><td>1.200.000</td><td>Bu Dita</td></tr>
        <tr><td>Jun</td><td>105.000</td><td>-</td><td>1.305.000</td><td></td></tr>
        <tr><td>Jul</td><td>110.000</td><td>200.000</td><td>1.210.000</td><td>Bu Mumu</td></tr>
        <tr><td>Agu</td><td>110.000</td><td>-</td><td>1.320.000</td><td></td></tr>
        <tr><td>Sep</td><td>110.000</td><td>-</td><td>1.430.000</td><td></td></tr>
        <tr><td>Okt</td><td>100.000</td><td>-</td><td>1.540.000</td><td></td></tr>
        <tr><td>Nov</td><td>105.000</td><td>200.000</td><td>1.440.000</td><td>Bu Mumu</td></tr>
        <tr><td>Des</td><td>115.000</td><td>100.000</td><td>1.445.000</td><td>Pak Hasan</td></tr>
      </tbody>
      <tfoot class="table-secondary fw-bold">
        <tr><td>Total</td><td>1.270.000</td><td>1.300.000</td><td>1.445.000</td><td></td></tr>
      </tfoot>
    </table>

    <!-- Tahun 2024 -->
    <h3 class="mt-4">Tahun 2024</h3>
    <table class="table table-bordered table-striped" id="table2024">
      <thead class="table-dark">
        <tr>
          <th>Bulan</th><th>Pemasukan (Rp)</th><th>Pengeluaran (Rp)</th><th>Saldo (Rp)</th><th>Catatan</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Jan</td><td>115.000</td><td>200.000</td><td>1.360.000</td><td>Bu Tiffany</td></tr>
        <tr><td>Feb</td><td>110.000</td><td>400.000</td><td>1.070.000</td><td>Bu Agus, Bu Dita</td></tr>
        <tr><td>Mar</td><td>115.000</td><td>400.000</td><td>785.000</td><td>Bu Tiffany, Bu Dita</td></tr>
        <tr><td>Apr</td><td>110.000</td><td>400.000</td><td>495.000</td><td>Bu Wiwik, Bu Eka</td></tr>
        <tr><td>Mei</td><td>110.000</td><td>-</td><td>605.000</td><td></td></tr>
        <tr><td>Jun</td><td>115.000</td><td>-</td><td>720.000</td><td></td></tr>
        <tr><td>Jul</td><td>110.000</td><td>-</td><td>830.000</td><td></td></tr>
        <tr><td>Agu</td><td>110.000</td><td>-</td><td>940.000</td><td></td></tr>
        <tr><td>Sep</td><td>110.000</td><td>-</td><td>1.050.000</td><td></td></tr>
        <tr><td>Okt</td><td>115.000</td><td>-</td><td>1.165.000</td><td></td></tr>
        <tr><td>Nov</td><td>95.000</td><td>-</td><td>1.260.000</td><td></td></tr>
        <tr><td>Des</td><td>100.000</td><td>-</td><td>1.360.000</td><td></td></tr>
      </tbody>
      <tfoot class="table-secondary fw-bold">
        <tr><td>Total</td><td>1.315.000</td><td>1.400.000</td><td>1.360.000</td><td></td></tr>
      </tfoot>
    </table>

    <!-- Tahun 2025 -->
    <h3 class="mt-4">Tahun 2025</h3>
    <table class="table table-bordered table-striped" id="table2025">
      <thead class="table-dark">
        <tr>
          <th>Bulan</th><th>Pemasukan (Rp)</th><th>Pengeluaran (Rp)</th><th>Saldo (Rp)</th><th>Catatan</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Jan</td><td>100.000</td><td>-</td><td>1.460.000</td><td></td></tr>
        <tr><td>Feb</td><td>100.000</td><td>-</td><td>1.560.000</td><td></td></tr>
        <tr><td>Mar</td><td>105.000</td><td>-</td><td>1.665.000</td><td></td></tr>
        <tr><td>Apr</td><td>105.000</td><td>-</td><td>1.770.000</td><td></td></tr>
        <tr><td>Mei</td><td>105.000</td><td>-</td><td>1.875.000</td><td></td></tr>
        <tr><td>Jun</td><td>90.000</td><td>200.000</td><td>1.765.000</td><td>Dita</td></tr>
        <tr><td>Jul</td><td>-</td><td>200.000</td><td>1.565.000</td><td>Bu Agus</td></tr>
      </tbody>
      <tfoot class="table-secondary fw-bold">
        <tr><td>Total (Jan–Jul)</td><td>605.000</td><td>400.000</td><td>1.565.000</td><td></td></tr>
      </tfoot>
    </table>
  </div>
</div>

<script>
function exportTableToExcel(){
  var wb = XLSX.utils.book_new();
  ["table2022","table2023","table2024","table2025"].forEach(id=>{
    var ws = XLSX.utils.table_to_sheet(document.getElementById(id));
    XLSX.utils.book_append_sheet(wb, ws, id.replace("table",""));
  });
  XLSX.writeFile(wb,"Laporan_Dana_Sosial_Rawinda_Pratama.xlsx");
}
</script>
</body>
</html>
